<div class="combined-container" fxLayout="row" fxLayoutGap="1rem" fxFlexFill>
    <!-- –õ–µ–≤—ã–π –±–ª–æ–∫: —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ -->
    <div class="book-list" fxFlex="60">
      <ng-container *ngIf="!(books$ | async) as books; else loaded">
        <div class="loading-message">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥...</div>
      </ng-container>
  
      <ng-template #loaded>
        <ng-container *ngIf="(books$ | async) as books">
          <div *ngIf="books.length === 0" class="empty-message">
            üì≠ –ü–æ–∫–∞ –Ω–µ—Ç –∫–Ω–∏–≥. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!
          </div>
  
          <div *ngIf="books.length > 0" class="books-container" fxLayout="row wrap" fxLayoutGap="1rem" fxLayoutAlign="center start">
            <mat-card class="book-card"
                      *ngFor="let book of books"
                      (click)="goToDetail(book.id)"
                      matRipple
                      matRippleColor="rgba(0,0,0,0.1)">
              <mat-card-header>
                <div mat-card-avatar class="book-avatar">
                  <span class="book-emoji" aria-hidden="true">üìö</span>
                </div>
                <mat-card-title class="book-title">{{ book.title }}</mat-card-title>
                <mat-card-subtitle class="book-authors">{{ book.authors }}</mat-card-subtitle>
              </mat-card-header>
              <div class="book-cover-emoji">
                <span class="cover-emoji" aria-hidden="true">üìñ</span>
              </div>
              <mat-card-content>
                <p class="book-description">
                  {{ book.description | slice:0:100 }}<span *ngIf="book.description?.length > 100">...</span>
                </p>
              </mat-card-content>
              <mat-card-actions align="end">
                <button mat-button color="primary" (click)="goToDetail(book.id); $event.stopPropagation()">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
              </mat-card-actions>
            </mat-card>
          </div>
        </ng-container>
      </ng-template>
    </div>
  
    <!-- –ü—Ä–∞–≤—ã–π –±–ª–æ–∫: –¥–µ—Ç–∞–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–∏–≥–∏ -->
    <div class="book-detail-panel" fxFlex="40" *ngIf="selectedBook">
      <mat-card class="book-detail-card" fxLayout="column" fxLayoutGap="1rem">
        <mat-card-header>
          <div mat-card-avatar class="book-avatar">
            <span class="book-emoji" aria-hidden="true">üìö</span>
          </div>
          <mat-card-title>{{ selectedBook.title }}</mat-card-title>
          <mat-card-subtitle>{{ selectedBook.authors }}</mat-card-subtitle>
        </mat-card-header>
  
        <img mat-card-image [src]="selectedBook.coverUrl || 'assets/default-cover.jpg'" alt="{{ selectedBook.title }}" class="book-cover">
  
        <mat-card-content>
          <p class="description">{{ selectedBook.description }}</p>
  
          <div class="genres" *ngIf="selectedBook.genres && selectedBook.genres.length">
            <mat-chip-set>
              <mat-chip *ngFor="let genre of selectedBook.genres" color="primary" selected>
                {{ genre }}
              </mat-chip>
            </mat-chip-set>
          </div>
  
          <p class="created-date">
            –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: {{ selectedBook.created_at | date:'mediumDate' }}
          </p>
        </mat-card-content>
  
        <mat-card-actions align="end">
          <button mat-raised-button color="accent" (click)="downloadPdf(selectedBook.id)">
            <mat-icon>download</mat-icon>
            –°–∫–∞—á–∞—Ç—å PDF
          </button>
          <button mat-button (click)="closeDetail()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
  
  <!-- –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–Ω–∏–≥–∏ -->
  <button mat-fab color="primary" class="upload-fab" (click)="openUploadDialog()">
    <mat-icon>cloud_upload</mat-icon>
  </button>
  